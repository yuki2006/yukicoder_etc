<title>モンゴメリ乗算</title>
<p>モンゴメリ乗算(Montgomery multiplication)は、剰余環での演算を定数倍高速化するテクニックである。</p>
<h3>Montgomery reduction</h3>
<p>
$0 &lt; m, n$を、$\gcd(m, n) = 1$となる固定された2つの整数としたとき、整数$a$に対し$a \times n^{-1} \bmod m$を計算したいとする。
素直に計算する場合、$n^{-1} \pmod m$は事前に計算しておくとしても、$a$にそれを掛け算した後$m$での剰余演算が必要になる。
Montgomery reductionの基本的なアイデアは、$n^{-1}$を掛ける代わりに「実際に$n$で割る」ことで、$m$での剰余を取らなくてもよいように効果的に"reduce"できる、ということである。
</p>
<p>
$r \equiv (-m)^{-1} \pmod n$となる$0 \le r &lt; n$を事前に計算しておく。
$b = a \times r \bmod n$とし、$t = a + b \times m$とすると、$t \equiv a \pmod m$かつ$t \equiv 0 \pmod n$となる。
これは中国人剰余定理をしているのと同じであることに注意しておく。
さて、この$t$は$n$の倍数であるので、逆元を使わなくても整数上の割り算ができる。これにより、$t / n \equiv a n^{-1} \pmod m$となる答えが計算できた。
</p>
<p>
$t / n$の大きさを考えよう。$0 \le a &lt; m n$と仮定すると、(あとで書く)、$t &lt; 2m$となる。よって、最後に引き算をするだけで$m$未満の標準形へ"reduce"できた。
</p>
<p>
$n$が2の累乗である場合、これは割り算を使わずに計算できる。よって、高速になりうる。(あとでもっと詳しく書く)
</p>
