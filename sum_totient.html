本項ではオイラーのトーティエント関数$\phi(i)$の和$\sum_{i=1}^{n}{\phi (i)}$を$O(n^{2/3}{\log\log{n}}^{2/3})$で求めるアルゴリズムを紹介いたします。
オイラーのトーティエント関数$\phi{i}$は$1$から $n$ までの整数のうち $n$ と互いに素なものの個数と定義します。
このアルゴリズムはプロジェクトオイラーの問題として何度か出題されていますが、
競技プログラミングの問題としては筆者は見たこと見たことがありません。他にも、他の界隈では有名だが競技プログラミングの界隈ではあまり知られていないアルゴリズムがたくさんあると思います そのような問題をどんどん共有したいと思って本稿を書いています。計算量解析についてかならいさんに教えていただきました。感謝いたします。
<br>
<br>
まず準備として、任意の正の整数$m$について $m = \sum_{dはmの因数}{　φ(d)}$ を示します。 
ここでは$m$との最大公約数が$g$であるものが、$g×$（$m$と互いに素な数）と書けることに注目しましょう。
$g×$（mと互いに素な数）$≦ m$ですから、$g$にかかる（$m$と互いに素な数）は$[m/g]$以下です。
したがって、$m$との最大公約数が$g$となるような数の個数は、$n$と互いに素な数のうち$[m/g]$以下の者の個数と等しくなります。
つまり$φ([m/g])$個あります。
ここで $g$ を $m$ の因数すべてについて試して、和をとるとそれは$1$から $n$ までの数すべてに渡って一つずつ数えたのと同じです。
したがって 任意の正の整数について、$m = \sum_{dはmの因数}{　φ(d)}$を取ったものとなります。
<br>
<br>
$m = \sum_{dはmの因数}{　φ(d)}$の $m$ を$1$から $N$ まで変化させたときの和を取り、変形します。
<br>
$1+2+...+N = \sum_{dは1の因数}{　φ(d)}+\sum_{dは2の因数}{　φ(d)}+...+\sum_{dはNの因数}{　φ(d)}$
<br>
$N(N+1)/2 = \sum_{n=1}^N \sum_{i=1}^{[N/n]}{　φ(i)}$
<br>
$N(N+1)/2 = \sum_{n=2}^N \sum_{i=1}^{[N/n]}{　φ(i)} + \sum_{n=1}^N {　φ(n)}$
<br>
ここで、オイラーのトーティエント関数$\phi(i)$を$i=1,2,...,n$まで変化させたときの和を$\phi{n}=\sum_{i=1}^{n}{\phi(i)}$と定義します。
すると上の式は
<br>
$N(N+1)/2 = \sum_{n=2}^N \Phi(N/n) + \Phi(N)$
$\Phi(N) = N(N+1)/2 - \sum_{n=2}^N \Phi([N/n])$
とできます。ここで、$\Phi{N}$が求めたい値になっています。