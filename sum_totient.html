本項では$\sum_{i=1}^{n}{\phi (i)}$を$O(n^{2/3}{\log\log{n}}^{2/3})$で求めるアルゴリズムを紹介いたします。
このアルゴリズムはプロジェクトオイラーの問題として何度か出題されていますが、
競技プログラミングの問題としては筆者は見たこと見たことがありません。他にも、他の界隈では有名だが競技プログラミングの界隈ではあまり知られていないアルゴリズムがたくさんあると思います そのような問題をどんどん共有したいと思って本稿を書いています。計算量解析についてかならいさんに教えていただきました。感謝いたします。
$1$から $n$ までの整数のうち $n$ と互いに素なものの個数をオイラーのトーシェント関数$φ(n)$と定義します。このオイラーのトーシェント関数$φ(n)$について、$n$に$1$から $N$ までを代入したもの和を高速に計算するアルゴリズムを紹介いたします。まず準備として、任意の正の整数$m$について $m = Σ_{dはmの因数} φ(d)$ を示します。 ここでは$m$との最大公約数が$g$であるものが、$g$×（$m$と互いに素な数）と書けることに注目しましょう。$g×（mと互いに素な数）≦ m$ですから、$g$にかかえる（$m$と互いに素な数）は$[ｍ/g]$以下です。したがって、$m$との最大公約数が$g$となるような数の個数は、$n$と互いに素な数のうち$[m/g]$以下の者の個数と等しくなります。つまり$φ([m/g])$個あります。ここで $g$ を $m$ の因数すべてについて試して、和をとるとそれは$1$から $n$ までの数すべてに渡って一つずつ数えたのと同じです。したがって 任意の正の整数について、$m = Σ_{dはmの因数} φ(d)$を取ったものとなります。
