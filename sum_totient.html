本項では$\sum_{i=1}^{n}{\phi (i)}$を$O(n^{2/3}{\log\log{n}}^{2/3})$で求めるアルゴリズムを紹介いたします。
このアルゴリズムはプロジェクトオイラーの問題として何度か出題されていますが、
競技プログラミングの問題としては筆者は見たこと見たことがありません。他にも、他の界隈では有名だが競技プログラミングの界隈ではあまり知られていないアルゴリズムがたくさんあると思います そのような問題をどんどん共有したいと思って本稿を書いています。計算量解析についてかならいさんに教えていただきました。感謝いたします。
1から n までの整数のうち n と互いに素なものの個数をオイラーのトーシェント関数φ(n)と定義します。このオイラーのトーシェント関数φ(n)について、nに1から N までを代入したもの和を高速に計算するアルゴリズムを紹介いたします。まず準備として、任意の正の整数ｍについて ｍ = Σ_{dはｍの因数} φ(d) を示します。 ここではｍとの最大公約数がｇであるものが、ｇ×（ｎと互いに素な数）と書けることに注目しましょう。ｇ×（ｍと互いに素な数）≦ ｍですから、ｇにかかえる（ｍと互いに素な数）は[ｍ/g]以下です。したがって、ｍとの最大公約数がｇとなるような数の個数は、ｎと互いに素な数のうち[ｍ/g]以下の者の個数と等しくなります。つまりφ（[ｍ/g])個あります。ここで g を ｍ の因数すべてについて試して、和をとるとそれは1から n までの数すべてに渡って一つずつ数えたのと同じです。したがって 任意の正の整数について、ｍ = Σ_{dはｍの因数} φ(d)を取ったものとなります。
