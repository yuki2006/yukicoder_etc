<title>数学的な性質</title>

このページは,競技プログラミングで使うことがある数学的性質・テクニックをまとめるページです。<br>
初めての人から見て、自明ではなさそうなものをまとめたいと思います。
必須な知識ではない豆知識的な項目もあります。<br>
特に明記されてなければ,整数を扱うものとします。


<dl>
    <dt>和なら剰余を先に行っても良い  (差も同様だが、負になる時は気をつける)</dt>
    <dd>$(a+b) \% m =((a\%m) +(b\%m))\%m $ <br>
    $a=km+i,b=lm+j$とおくと,$(a+b) \% m =(km+i+lm+j)\% m = (i+j)\%m= ((a\%m)+(b\%m))\%m $</dd>


    <dt>積なら剰余を先に行っても良い</dt>
    <dd>$(a*b) \% m =((a\%m)*(b\%m))\%m $ <br>
    $a=km+i,b=lm+j$とおくと,$(a*b) \% m =((km+i)*(lm+j))\% m = (klm^2+kmj+lmi+ij)\%m = ij \%m =(a\%m)*(b\%m)\%m $</dd>


    <dt>$a,b$ が正なら $a / b$ の切り上げは (a+b-1) /b </dt>
    <dd>$a$が$b$の倍数の時は $a = k b$ なので $k \le a/b + (b-1) /b < k+1$ になります。<br>
それ以外は$a$ を$b$で割ったあまりは$1$ ~ $b-1$ のどれかになります。<br>
つまり $a= kb+ 1$ .... $a=kb+(b-1)$ のどれかで表されることになります。<br>
つまり それらに $b-1$をたしても。 $a+b-1=kb+b=(k+1)b$ ...$ a+b-1=(k+2)b-2$ のどれかで表されることになります。<br>
両辺を$b$で割った時の範囲は以下のようになります。<br>
$(k+1) \le (a+b-1)/b < (k+2)$<br>
整数型が切り捨てられることを利用すると、<br>
$(a+b-1) /b$ での計算値は、$a$が$b$で割り切れる時は $k $,割り切れない時は $k+1$になります。</dd>

    <dt>$a$と$p$が互いに素なときに, $\frac{n}{a} \%p = n*a^{p-2} \%p$である.</dt>
<dd>
      整数$a$の、法$p$に関する合同類環における乗法逆元$a^{-1}$を求める。<br>
        フェルマーの小定理より、$a$と$p$が互いに素なとき、<br>
            $a^{p-1} \equiv 1 \pmod p$<br>
        変形すると、<br>
            $a*a^{p-2} \equiv 1 \pmod p$<br>
        となるので、$a^{-1}=a^{p-2}$である。<br>
        $n/a%p$を求めるには、両辺に$n$をかけて$a$で割ると、<br>
            $na^{p-2} \equiv n/a \pmod p$<br>
        となるので、$\frac{n}{a} \%p = n*a^{p-2} \%p$である。<br>
        この性質を使うと、組み合わせのコンビネーション$C$など,剰余を求める必要があるが割り算が発生する際などに利用できる.<br>
        （data9824さんのコメントから拝借いたしました。）
</dd>
    <dt>整数値$N$を2乗したものを4で割った時のあまりは、$N$が偶数の場合は$0$,$N$が奇数の場合$1$</dt>
    <dd>$N=2k$の時、$N^2=4k^2$.$N=2k+1$の時、$N^2=4k^2+4k+1=4(k^2+k)+1$であるため</dd>
</dl>